<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–ê–¥–º–∏–Ω ‚Äî –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞</title>
<style>
  body { font-family: sans-serif; background: #f6f7fb; padding: 24px; }
  .card { background: #fff; max-width: 720px; margin: auto; padding: 24px; border-radius: 12px; box-shadow: 0 6px 18px rgba(0,0,0,0.06); }
  input, button { width: 100%; padding: 12px; margin-top: 10px; font-size: 16px; }
  .qr { text-align: center; margin-top: 16px; }
  img { max-width: 220px; }
</style>
</head>
<body>

<script>
  const REQUIRED_PASSWORD = "klondike2025";
  const entered = prompt("üîí –í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞:");
  if (entered !== REQUIRED_PASSWORD) {
    alert("‚õî –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å");
    location.href = "https://google.com";
  }
</script>

<div class="card">
  <h2>–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∑–∞–∫–∞–∑–∞</h2>
  <input id="client_name" placeholder="–§–ò–û –∫–ª–∏–µ–Ω—Ç–∞">
  <input id="pickup_code" placeholder="–ö–æ–¥ –≤—ã–¥–∞—á–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 4721)">
  <input id="pvz" placeholder="–ê–¥—Ä–µ—Å –ü–í–ó">
  <input id="expires" type="date" placeholder="–°—Ä–æ–∫ —Ö—Ä–∞–Ω–µ–Ω–∏—è (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)">
  <button onclick="createOrder()">–°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑</button>
  <div id="result" class="qr"></div>
</div>
<script>
const API = "http://localhost:5000";
function createOrder(){
  const payload = {
    client_name: document.getElementById("client_name").value.trim(),
    pickup_code: document.getElementById("pickup_code").value.trim(),
    pvz: document.getElementById("pvz").value.trim(),
    expires: document.getElementById("expires").value
  };
  fetch(API + "/create", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(payload)
  }).then(r => r.json()).then(d => {
    if(!d.success) { alert("–û—à–∏–±–∫–∞: " + (d.error || "–Ω–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å")); return; }
    const q = encodeURIComponent(JSON.stringify(d.qr_payload));
    const url = `https://api.qrserver.com/v1/create-qr-code/?data=${q}&size=220x220`;
    document.getElementById("result").innerHTML = `
      <p>–ó–∞–∫–∞–∑ ‚Ññ <b>${d.order_id}</b> —Å–æ–∑–¥–∞–Ω</p>
      <img src="${url}" alt="QR">
      <div><button onclick="window.print()">–ü–µ—á–∞—Ç—å</button></div>
    `;
  }).catch(e => alert("–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: " + e));
}
</script>
</body>
</html>
